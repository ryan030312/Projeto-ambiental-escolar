<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>A Vida de Ryan - 35 Perguntas sobre Polui√ß√£o (Final)</title>
<style>
  :root{--bg:#e8f7fb;--card:#fff;--accent:#00796b;--ok:#2e7d32;--bad:#c62828;--neutral:#00695c}
  body{
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    background:linear-gradient(180deg,var(--bg),#dff3f2);
    font-family:Inter, system-ui, Arial, sans-serif;
  }
  #game{
    width:95%;
    max-width:760px;
    background:var(--card);
    border-radius:12px;
    padding:18px;
    box-shadow:0 8px 30px rgba(0,0,0,0.12);
    text-align:center;
    position:relative;
    overflow:visible;
  }
  h1{margin:6px 0 12px;font-size:22px;color:var(--accent)}
  #meta{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-bottom:10px}
  .panel{background:#f7fffd;padding:8px 12px;border-radius:8px;border:1px solid rgba(0,0,0,0.04);font-weight:600}
  #question{min-height:68px;padding:10px 6px;font-size:18px}
  #choices{display:flex;flex-direction:column;gap:10px;align-items:center;margin-top:6px}
  .btn{
    min-width:220px;
    width:80%;
    max-width:420px;
    padding:12px 14px;
    font-size:16px;
    border-radius:10px;
    border:0;
    cursor:pointer;
    box-shadow:0 4px 12px rgba(0,0,0,0.06);
    background:#f1f8f7;
    transition:transform .08s ease,box-shadow .08s;
  }
  .btn:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,0,0,0.08)}
  .btn:active{transform:translateY(0)}
  #continue{padding:10px 14px; border-radius:10px; background:#1976d2;color:#fff;border:0;cursor:pointer;margin-top:8px}
  #overlayCanvas{position:absolute;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:6}
  /* X / neutral animation */
  #xEffect{
    position:absolute;
    left:50%;
    top:50%;
    transform:translate(-50%,-140%);
    font-size:86px;
    color:var(--bad);
    display:none;
    z-index:7;
    text-shadow:0 6px 18px rgba(0,0,0,0.12);
    animation:pop 700ms ease-out;
  }
  @keyframes pop{0%{transform:translate(-50%,-140%) scale(.2) rotate(-15deg);opacity:0}50%{opacity:1;transform:translate(-50%,-140%) scale(1.08) rotate(5deg)}100%{transform:translate(-50%,-140%) scale(1) rotate(0)}}
  footer{margin-top:12px;font-size:13px;color:#456;opacity:.95}
  #scoreBreak{font-size:13px;margin-top:6px;color:#333}
  @media(min-width:640px){
    #choices{flex-direction:row;flex-wrap:wrap;justify-content:center}
    .btn{width:auto}
  }
</style>
</head>
<body>
  <div id="game">
    <canvas id="overlayCanvas"></canvas>
    <div id="xEffect">‚ùå</div>

    <h1>A Vida de Ryan ‚Äî Proteja os Rios (35)</h1>

    <div id="meta">
      <div class="panel" id="scoreBoard">Pontua√ß√£o: 0</div>
      <div class="panel" id="remaining">Quest√µes restantes: 35</div>
      <div class="panel" id="currentScene">Quest√£o: 0 / 35</div>
    </div>

    <div id="question">Clique em "Come√ßar" para iniciar o jogo!</div>

    <div id="choices">
      <button class="btn" id="startBtn">Come√ßar</button>
    </div>

    <div id="scoreBreak"></div>
    <footer>Foque em atitudes que reduzem lixo e protegem rios e c√≥rregos.</footer>
  </div>

<script>
/* ====== SONS por WebAudio (sem arquivos externos) ====== */
const AudioCtx = (window.AudioContext||window.webkitAudioContext);
let audioCtx = null;
function ensureAudio() { if(!audioCtx) audioCtx = new AudioCtx(); }

/* som de acerto: pequena sequ√™ncia ascendente */
function playCorrectSound(){
  ensureAudio();
  const now = audioCtx.currentTime;
  const o1 = audioCtx.createOscillator();
  const o2 = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o1.type = 'sine'; o2.type = 'triangle';
  o1.frequency.setValueAtTime(520, now);
  o2.frequency.setValueAtTime(720, now);
  o1.frequency.linearRampToValueAtTime(780, now + 0.20);
  o2.frequency.linearRampToValueAtTime(980, now + 0.20);
  g.gain.setValueAtTime(0, now);
  g.gain.linearRampToValueAtTime(0.18, now + 0.01);
  g.gain.linearRampToValueAtTime(0.001, now + 0.28);
  o1.connect(g); o2.connect(g); g.connect(audioCtx.destination);
  o1.start(now); o2.start(now);
  o1.stop(now + 0.3); o2.stop(now + 0.3);
}

/* som de erro: curto ru√≠do descendente */
function playWrongSound(){
  ensureAudio();
  const now = audioCtx.currentTime;
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = 'sawtooth';
  o.frequency.setValueAtTime(260, now);
  o.frequency.exponentialRampToValueAtTime(80, now + 0.22);
  g.gain.setValueAtTime(0, now);
  g.gain.linearRampToValueAtTime(0.22, now + 0.01);
  g.gain.exponentialRampToValueAtTime(0.001, now + 0.28);
  o.connect(g); g.connect(audioCtx.destination);
  o.start(now); o.stop(now + 0.28);
}

/* som neutro (meia-certa): pequeno 'plim' suave */
function playNeutralSound(){
  ensureAudio();
  const now = audioCtx.currentTime;
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = 'sine';
  o.frequency.setValueAtTime(660, now);
  o.frequency.exponentialRampToValueAtTime(840, now + 0.12);
  g.gain.setValueAtTime(0, now);
  g.gain.linearRampToValueAtTime(0.08, now + 0.005);
  g.gain.exponentialRampToValueAtTime(0.001, now + 0.18);
  o.connect(g); g.connect(audioCtx.destination);
  o.start(now); o.stop(now + 0.2);
}

/* ====== PARTICLES / FIREWORKS (Canvas) ====== */
const canvas = document.getElementById('overlayCanvas');
const ctx = canvas.getContext('2d');
const game = document.getElementById('game');
function resizeCanvas(){ canvas.width = game.clientWidth; canvas.height = game.clientHeight; }
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

let particles = [];
function spawnFireworks(x,y, color){
  for(let i=0;i<40;i++){
    particles.push({
      x: x + (Math.random()-0.5)*80,
      y: y + (Math.random()-0.5)*40,
      vx:(Math.random()-0.5)*6,
      vy:(Math.random()-1.5)*6,
      life:60 + Math.random()*40,
      r:1 + Math.random()*3,
      col: color
    });
  }
}
function stepParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.vy += 0.12;
    p.x += p.vx; p.y += p.vy;
    p.life--;
    const alpha = Math.max(0, p.life/100);
    ctx.beginPath();
    ctx.fillStyle = `rgba(${p.col.r},${p.col.g},${p.col.b},${alpha})`;
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fill();
    if(p.life<=0) particles.splice(i,1);
  }
  requestAnimationFrame(stepParticles);
}
stepParticles();

function randomColorRGB(){
  const palette = [
    {r:255,g:80,b:80},{r:255,g:190,b:60},{r:60,g:180,b:120},
    {r:80,g:150,b:255},{r:180,g:80,b:255},{r:255,g:120,b:180}
  ];
  return palette[Math.floor(Math.random()*palette.length)];
}

/* ====== JOGO: 35 perguntas sobre polui√ß√£o (rios, lixo, descarte) ====== */
let sceneIndex = 0;
let scores = {env:0,eth:0,resp:0};

/* Perguntas (cada uma tem 3 op√ß√µes). Valores originais mantidos, mas o jogo NORMALIZA a resposta:
   >0 => correta (+1), 0 => neutra (0), <0 => errada (-1)
   (Isso permite manter mensagens originais e usar a nova regra sem reescrever todo o array.)
*/
const questions = [
  {q:"Voc√™ acabou de comer um doce no carro. Joga o papel de bala pela janela?", opts:[
    {t:"Jogo pela janela", type:"env", score:-1, msg:"O papel pode ser levado pela chuva aos rios."},
    {t:"Guardo e jogo no lixo depois", type:"env", score:2, msg:"Boa! Jogar no lixo evita polui√ß√£o nos rios."},
    {t:"Coloco na mochila para descartar depois", type:"env", score:1, msg:"√ìtimo ‚Äî guardar e descartar corretamente √© √∫til."}
  ]},
  {q:"V√™ uma garrafa pl√°stica no ch√£o, pr√≥xima a um c√≥rrego. O que faz?", opts:[
    {t:"Ignoro", type:"env", score:-1, msg:"A garrafa pode acabar no c√≥rrego e prejudicar animais."},
    {t:"Pego e jogo em uma lixeira", type:"env", score:2, msg:"Excelente ‚Äî evita que o lixo entre no c√≥rrego."},
    {t:"Levo para reciclagem em casa", type:"env", score:2, msg:"√ìtimo: reciclar √© a melhor op√ß√£o quando poss√≠vel."}
  ]},
  {q:"Percebe lixo pr√≥ximo a um bueiro que pode entupir. O que faz?", opts:[
    {t:"Ignoro", type:"env", score:-1, msg:"Bueiros entupidos agravam enchentes e levam lixo aos rios."},
    {t:"Registro com foto e denuncio √† prefeitura", type:"env", score:1, msg:"Denunciar facilita a limpeza oficial."},
    {t:"Se for seguro, removo o lixo ou chamo vizinhos para mutir√£o", type:"env", score:2, msg:"A√ß√£o comunit√°ria ajuda muito a prevenir enchentes."}
  ]},
  {q:"Est√° em um passeio e tem um saquinho com lixo. O que faz?", opts:[
    {t:"Jogo no ch√£o se n√£o houver lixeira vis√≠vel", type:"env", score:-1, msg:"Lixo no ch√£o acaba chegando aos rios."},
    {t:"Guardo at√© encontrar uma lixeira", type:"env", score:2, msg:"Muito bem ‚Äî carregar at√© o descarte correto √© respons√°vel."},
    {t:"Procuro lixeira pr√≥xima e separo recicl√°veis", type:"env", score:2, msg:"Separar recicl√°veis ajuda o meio ambiente."}
  ]},
  {q:"Seu vizinho despeja √≥leo de fritura na rua. Voc√™‚Ä¶", opts:[
    {t:"N√£o fa√ßo nada", type:"env", score:-2, msg:"√ìleo polui o solo e pode alcan√ßar rios."},
    {t:"Digo que isso prejudica o meio ambiente e encaminho orienta√ß√£o", type:"env", score:2, msg:"Educar √© importante e ajuda a mudar comportamento."},
    {t:"Registro e notifico o servi√ßo p√∫blico que trata res√≠duos", type:"env", score:1, msg:"Den√∫ncias ajudam na fiscaliza√ß√£o."}
  ]},
  {q:"Em festa na rua, as pessoas jogam copos e embalagens. Voc√™‚Ä¶", opts:[
    {t:"Jogo junto para n√£o ser exclu√≠do", type:"env", score:-1, msg:"Acompanhando, o lixo se espalha e pode ir aos rios."},
    {t:"Recolho o que posso e separo para reciclar", type:"env", score:2, msg:"√ìtimo ‚Äî atitudes pr√°ticas reduz a polui√ß√£o."},
    {t:"Convido amigos a ajudar a limpar", type:"env", score:2, msg:"Mobilizar o grupo aumenta o impacto positivo."}
  ]},
  {q:"Recebe folhetos/descart√°veis em evento. O que faz com os que n√£o quer?", opts:[
    {t:"Jogo no ch√£o", type:"env", score:-1, msg:"Folhetos no ch√£o viram lixo urbano."},
    {t:"Reutilizo como rascunho ou levo para reciclar", type:"env", score:1, msg:"Reusar diminui o que vira lixo."},
    {t:"Recuso folhetos desnecess√°rios na origem", type:"env", score:2, msg:"Evitar na origem reduz muito o desperd√≠cio."}
  ]},
  {q:"V√™ algu√©m jogando bituca de cigarro no ch√£o perto do c√≥rrego. O que faz?", opts:[
    {t:"Ignoro", type:"env", score:-1, msg:"Bitucas contaminam a √°gua e prejudicam fauna."},
    {t:"Explico que √© poluente e pe√ßo para jogar no lixo", type:"env", score:2, msg:"Educar pode evitar o problema."},
    {t:"Recolho a bituca com cuidado e a descarto em lixeira", type:"env", score:2, msg:"Recolher ajuda a limpar e evita que chegue ao rio."}
  ]},
  {q:"V√™ uma lona/pl√°stico solto pr√≥ximo a um c√≥rrego (vai voar com o vento). O que faz?", opts:[
    {t:"Deixo l√°", type:"env", score:-1, msg:"Pl√°sticos soltos acabam no curso d'√°gua."},
    {t:"Fixar ou recolher e descartar", type:"env", score:2, msg:"Boa a√ß√£o: evita que o pl√°stico v√° para o rio."},
    {t:"Aviso algu√©m respons√°vel para recolher de forma segura", type:"env", score:1, msg:"Avisar a equipe local √© √∫til."}
  ]},
  {q:"Vai ao mercado e precisa escolher entre produto com muita embalagem ou sem. Voc√™‚Ä¶", opts:[
    {t:"Escolho o com mais embalagem", type:"env", score:-1, msg:"Mais embalagem significa mais lixo eventual no rio."},
    {t:"Escolho op√ß√µes sem embalagem ou a granel", type:"env", score:2, msg:"Reduzir embalagens diminui lixo urbano."},
    {t:"Prefiro embalagem retorn√°vel", type:"env", score:1, msg:"Embalagens retorn√°veis s√£o uma boa op√ß√£o."}
  ]},
  {q:"Encontra um saco de lixo rasgado perto do c√≥rrego. O que faz?", opts:[
    {t:"Passo direto", type:"env", score:-1, msg:"O conte√∫do pode ser levado pela chuva para o rio."},
    {t:"Recolho com cuidado e coloco em novo saco", type:"env", score:2, msg:"A√ß√£o direta previne que o lixo alcance o c√≥rrego."},
    {t:"Registro e aviso o servi√ßo de limpeza p√∫blica", type:"env", score:1, msg:"Denunciar ajuda com coleta adequada."}
  ]},
  {q:"Voc√™ v√™ uma placa p√∫blica sobre descarte correto mas ningu√©m segue. Voc√™‚Ä¶", opts:[
    {t:"Acho que n√£o adianta e ignoro", type:"resp", score:-1, msg:"Sem a√ß√µes, a situa√ß√£o n√£o muda."},
    {t:"Compartilho nas redes para aumentar alcance", type:"resp", score:2, msg:"Divulgar incentiva mais pessoas a seguir."},
    {t:"Convido vizinhos para campanha local", type:"resp", score:2, msg:"Mobiliza√ß√£o local gera resultados reais."}
  ]},
  {q:"Em casa, onde descartar pilhas e baterias?", opts:[
    {t:"Jogo no lixo comum", type:"env", score:-2, msg:"Pilhas contaminam solo e √°gua se descartadas incorretamente."},
    {t:"Levo a ponto de coleta adequado", type:"env", score:2, msg:"Ponto de coleta evita contamina√ß√£o dos rios."},
    {t:"Procuro campanhas de recolhimento em escola/loja", type:"env", score:1, msg:"Boa pr√°tica: buscar pontos de recolhimento."}
  ]},
  {q:"Ao viajar de carro, a carga do caminh√£o n√£o est√° coberta e papel/embalagens voam. Voc√™‚Ä¶", opts:[
    {t:"N√£o aviso nada", type:"env", score:-1, msg:"Carga solta gera muito lixo nas vias e rios."},
    {t:"Aviso ao motorista ou √† pol√≠cia rodovi√°ria", type:"env", score:2, msg:"Avisar evita que o lixo seja espalhado."},
    {t:"Registo e encaminho den√∫ncia ao √≥rg√£o competente", type:"env", score:1, msg:"Registrar facilita a√ß√µes futuras."}
  ]},
  {q:"V√™ algu√©m descartando restos de tinta ou solvente na rua. Voc√™‚Ä¶", opts:[
    {t:"N√£o me meto", type:"env", score:-2, msg:"Qu√≠micos podem contaminar o curso d'√°gua."},
    {t:"Informo os riscos e indico descarte correto", type:"env", score:2, msg:"Prevenir uso indevido de produtos qu√≠micos protege a √°gua."},
    {t:"Denuncio para √≥rg√£o ambiental", type:"env", score:1, msg:"Den√∫ncias auxiliam fiscaliza√ß√£o."}
  ]},
  {q:"H√° um ponto de encontro com muitas embalagens (lixo acumulado). Voc√™‚Ä¶", opts:[
    {t:"Tomo dist√¢ncia e nada fa√ßo", type:"env", score:-1, msg:"Pontos fixos de lixo atraem mais lixo e v√£o ao rio."},
    {t:"Participo de mutir√£o de limpeza local", type:"env", score:2, msg:"Mutir√µes reduzem polui√ß√£o de forma r√°pida."},
    {t:"Divulgo para prefeitura e vizinhan√ßa organizarem limpeza", type:"env", score:1, msg:"Mobilizar autoridades ajuda."}
  ]},
  {q:"Seu familiar sugere queimar lixo em quintal. Voc√™‚Ä¶", opts:[
    {t:"Queimo para reduzir volume", type:"env", score:-2, msg:"Queimar libera poluentes e n√£o resolve o problema do rio."},
    {t:"Explico os danos e procuro alternativa", type:"env", score:2, msg:"Buscar alternativas evita polui√ß√£o do ar e lixo no rio."},
    {t:"Ajudo a separar recicl√°veis e encaminhar corretamente", type:"env", score:1, msg:"Separar √© uma boa a√ß√£o pr√°tica."}
  ]},
  {q:"Em pescaria, encontra nylon/linha e isca no rio. O que faz?", opts:[
    {t:"Deixo, n√£o √© minha responsabilidade", type:"env", score:-1, msg:"Materiais de pesca machucam peixes e aves."},
    {t:"Recolho com cuidado e descarto", type:"env", score:2, msg:"Recolher protege a fauna e a √°gua."},
    {t:"Aviso outros pescadores sobre pr√°ticas seguras", type:"env", score:1, msg:"Educar previne novos descartes."}
  ]},
  {q:"V√™ lixo boiando no rio durante passeio. Voc√™‚Ä¶", opts:[
    {t:"Tiro foto e sigo sem agir", type:"resp", score:0, msg:"Foto ajuda se for reportada, mas a√ß√£o direta √© melhor."},
    {t:"Recolho quando poss√≠vel em seguran√ßa", type:"env", score:2, msg:"Recolher evita que o lixo siga rio abaixo."},
    {t:"Denuncio e incentivo campanha local", type:"resp", score:1, msg:"Denunciar e mobilizar aumenta solu√ß√£o."}
  ]},
  {q:"Tem op√ß√£o de usar canudo de pl√°stico ou sem canudo. Voc√™‚Ä¶", opts:[
    {t:"Pe√ßo canudo pl√°stico por comodidade", type:"env", score:-1, msg:"Canudos pequenos acabam em rios e oceanos."},
    {t:"Pe√ßo sem canudo", type:"env", score:2, msg:"Evitar canudos diminui micropl√°sticos."},
    {t:"Uso canudo reutiliz√°vel", type:"env", score:2, msg:"Reutiliz√°veis s√£o uma √≥tima op√ß√£o."}
  ]},
  {q:"No mercado, v√™ pilhas no corredor sem informa√ß√£o de coleta. Voc√™‚Ä¶", opts:[
    {t:"Compra e joga no lixo comum", type:"env", score:-2, msg:"Pilhas descartadas incorretamente contaminam √°gua."},
    {t:"Pergunto por pontos de devolu√ß√£o", type:"env", score:2, msg:"Buscar informa√ß√£o protege o meio ambiente."},
    {t:"Levo pilhas usadas a ponto de coleta depois", type:"env", score:1, msg:"Guardar at√© levar ao ponto √© v√°lido."}
  ]},
  {q:"Voc√™ organiza uma festa no quintal. Como evita lixo indo ao c√≥rrego?", opts:[
    {t:"N√£o me preocupo com descart√°veis", type:"env", score:-1, msg:"Descarte descuidado pode acabar no rio."},
    {t:"Disponibilizo lixeiras e separa√ß√£o para reciclagem", type:"env", score:2, msg:"Organizar o descarte evita polui√ß√£o."},
    {t:"Pe√ßo para convidados levarem suas embalagens", type:"env", score:1, msg:"Reduz embalagem e incentivo √† responsabilidade."}
  ]},
  {q:"V√™ entulho de constru√ß√£o pr√≥ximo a um curso d'√°gua. Voc√™‚Ä¶", opts:[
    {t:"Ignoro, n√£o √© problema meu", type:"env", score:-2, msg:"Entulho causa assoreamento e contamina√ß√£o."},
    {t:"Registro e denuncio ao √≥rg√£o competente", type:"env", score:2, msg:"Den√∫ncias levam √† remo√ß√£o e fiscaliza√ß√£o."},
    {t:"Organizo grupo para recolher em seguran√ßa", type:"env", score:1, msg:"Apoiar limpeza local √© muito positivo."}
  ]},
  {q:"Seu col√©gio prop√µe projeto de conscientiza√ß√£o sobre rios. Voc√™‚Ä¶", opts:[
    {t:"N√£o participo", type:"eth", score:0, msg:"Perde chance de aprender e mobilizar."},
    {t:"Participo e ajudo a divulgar", type:"eth", score:2, msg:"Projetos educam e mudam h√°bitos."},
    {t:"Uso o projeto para fazer mutir√µes", type:"eth", score:2, msg:"Combinar educa√ß√£o e a√ß√£o √© o ideal."}
  ]},
  {q:"Algu√©m descarta equipamentos eletr√¥nicos perto de uma √°rea verde. Voc√™‚Ä¶", opts:[
    {t:"Ignoro", type:"env", score:-2, msg:"E-lixo libera metais pesados que podem atingir a √°gua."},
    {t:"Procuro ponto de descarte correto e informo o respons√°vel", type:"env", score:2, msg:"E-lixo precisa de tratamento especializado."},
    {t:"Registro e divulgo para comunidade n√£o descartar", type:"resp", score:1, msg:"Avisar ajuda prevenir futuros descartes."}
  ]},
  {q:"Percebe √≥leo/combust√≠vel vazando de ve√≠culo perto do rio. Voc√™‚Ä¶", opts:[
    {t:"Passo adiante", type:"env", score:-2, msg:"√ìleos contaminam gravemente o curso d'√°gua."},
    {t:"Registro e aviso autoridade/servi√ßo ambiental", type:"env", score:2, msg:"Notificar ajuda interven√ß√£o r√°pida."},
    {t:"Tento conter com materiais absorventes (se seguro)", type:"env", score:1, msg:"Apenas se seguro ‚Äî conter pode diminuir dano."}
  ]},
  {q:"V√™ com√©rcio despejando restos de comida diretamente na rua (que vai ao bueiro). Voc√™‚Ä¶", opts:[
    {t:"N√£o me envolvo", type:"env", score:-1, msg:"Restos bloqueiam drenagem e seguem ao rio."},
    {t:"Converso com o comerciante sobre descarte correto", type:"env", score:2, msg:"Explicar alternativas ajuda a reduzir polui√ß√£o."},
    {t:"Registro e denuncio para fiscaliza√ß√£o sanit√°ria", type:"env", score:1, msg:"Fiscaliza√ß√£o √© importante para mudar pr√°ticas."}
  ]},
  {q:"Voc√™ encontra rede/objetos de pesca presos em galhos no rio. O que faz?", opts:[
    {t:"Deixo ‚Äî √© perigoso mexer", type:"env", score:-1, msg:"Res√≠duos continuam ferindo animais."},
    {t:"Falo com grupo local de prote√ß√£o animal para remover", type:"env", score:2, msg:"Acionar especialistas √© correto e seguro."},
    {t:"Anoto localiza√ß√£o e informo autoridades ambientais", type:"env", score:1, msg:"Informar facilita remo√ß√£o segura."}
  ]},
  {q:"V√™ espuma ou colora√ß√£o estranha na √°gua do c√≥rrego. Voc√™‚Ä¶", opts:[
    {t:"Acho normal e sigo", type:"env", score:-1, msg:"Sinais de polui√ß√£o devem ser reportados."},
    {t:"Registro e envio para √≥rg√£os ambientais", type:"env", score:2, msg:"Reportar ajuda a detectar polui√ß√£o."},
    {t:"Aviso vizinhos e pe√ßo cuidado com fontes suspeitas", type:"resp", score:1, msg:"Avisar aumenta vigil√¢ncia comunit√°ria."}
  ]},
  {q:"Durante limpeza comunit√°ria, encontra vidro quebrado perto do rio. Voc√™‚Ä¶", opts:[
    {t:"N√£o recolho por medo de me cortar", type:"env", score:-1, msg:"Vidros machucam fauna e pessoas."},
    {t:"Recolho com luvas e descarte seguro", type:"env", score:2, msg:"Recolher com seguran√ßa protege todos."},
    {t:"Indico local para coleta por equipe especializada", type:"env", score:1, msg:"Equipe especializada √© ideal para res√≠duos perigosos."}
  ]},
  {q:"V√™ pl√°stico micro preso em plantas aqu√°ticas. Voc√™‚Ä¶", opts:[
    {t:"Ignoro ‚Äî √© dif√≠cil remover", type:"env", score:-1, msg:"Micropl√°sticos prejudicam o ecossistema."},
    {t:"Recolho cuidadosamente o material vis√≠vel", type:"env", score:2, msg:"Remover pl√°sticos protege vida aqu√°tica."},
    {t:"Tiro foto e registro para iniciativa de pesquisa", type:"resp", score:1, msg:"Dados ajudam estudos sobre polui√ß√£o."}
  ]},
  {q:"Seu transporte p√∫blico tem lixo na √°rea do embarque. Voc√™‚Ä¶", opts:[
    {t:"Jogo meu lixo no ch√£o tamb√©m", type:"env", score:-1, msg:"Contribuir aumenta sujeira urbana."},
    {t:"Levo meu lixo at√© a lixeira e incentivo outros", type:"env", score:2, msg:"Exemplo influencia comportamento."},
    {t:"Registro e pe√ßo recolhimento ao respons√°vel", type:"resp", score:1, msg:"Relatar ajuda na limpeza do local."}
  ]},
  {q:"Sabe de ponto que frequentemente tem descarte ilegal de lixo. Voc√™‚Ä¶", opts:[
    {t:"Ignoro ‚Äî j√° √© comum", type:"env", score:-1, msg:"Aceitar normaliza o problema."},
    {t:"Organizo den√∫ncia coletiva e a√ß√£o de limpeza", type:"env", score:2, msg:"A√ß√£o coletiva costuma resolver."},
    {t:"Coloco placas informativas e lixeiras comunit√°rias", type:"resp", score:1, msg:"Preven√ß√£o local reduz descarte."}
  ]},
  {q:"Algu√©m oferece trocar lixo por dinheiro perto do rio. Voc√™‚Ä¶", opts:[
    {t:"Aceito por facilidade", type:"env", score:-1, msg:"Lixo mal gerenciado pode voltar ao rio."},
    {t:"Recuso e busco destina√ß√£o correta", type:"env", score:2, msg:"Recusar pr√°ticas ruins ajuda longamente."},
    {t:"Informo sobre canais oficiais de reciclagem", type:"resp", score:1, msg:"Educar sobre alternativas √© √∫til."}
  ]},
  {q:"√öltima pergunta: voc√™ quer se comprometer a pelo menos uma a√ß√£o para proteger rios (ex.: carregar lixo, denunciar, participar de mutir√£o)?", opts:[
    {t:"N√£o vou me comprometer", type:"resp", score:-1, msg:"Sem compromisso, mudan√ßas demoram a acontecer."},
    {t:"Sim ‚Äî escolho ao menos uma a√ß√£o e come√ßo hoje", type:"resp", score:3, msg:"Excelente! Pequenas a√ß√µes podem gerar grande impacto."},
    {t:"Vou come√ßar compartilhando e incentivando amigos", type:"resp", score:2, msg:"Divulgar cria efeito multiplicador."}
  ]}
];

/* ====== UI & Flow ====== */
const questionDiv = document.getElementById('question');
const choicesDiv = document.getElementById('choices');
const scoreBoard = document.getElementById('scoreBoard');
const remainingDiv = document.getElementById('remaining');
const currentSceneDiv = document.getElementById('currentScene');
const scoreBreak = document.getElementById('scoreBreak');
const xEffect = document.getElementById('xEffect');

function shuffleCopy(arr){
  const copy = arr.slice();
  for(let i=copy.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [copy[i], copy[j]] = [copy[j], copy[i]];
  }
  return copy;
}

function updateMeta(){
  const total = scores.env + scores.eth + scores.resp;
  scoreBoard.innerText = `Pontua√ß√£o: ${total}`;
  remainingDiv.innerText = `Quest√µes restantes: ${questions.length - sceneIndex}`;
  currentSceneDiv.innerText = `Quest√£o: ${Math.min(sceneIndex+1, questions.length)} / ${questions.length}`;
  scoreBreak.innerText = `Ambiental: ${scores.env}  ‚Ä¢  √âtica: ${scores.eth}  ‚Ä¢  Responsab.: ${scores.resp}`;
}

function resetGame(){
  sceneIndex = 0;
  scores = {env:0,eth:0,resp:0};
  updateMeta();
}

/* show scene */
function showScene(){
  if(sceneIndex >= questions.length){
    // fim
    questionDiv.innerText = `Fim do jogo! Pontua√ß√£o final: ${scores.env + scores.eth + scores.resp}`;
    choicesDiv.innerHTML = `<button class="btn" onclick="restartGame()">Jogar novamente</button>`;
    remainingDiv.innerText = `Quest√µes restantes: 0`;
    currentSceneDiv.innerText = `Quest√£o: ${questions.length} / ${questions.length}`;
    return;
  }
  const q = questions[sceneIndex];
  questionDiv.innerText = q.q;
  choicesDiv.innerHTML = '';
  // shuffle choices for display
  const shuffled = shuffleCopy(q.opts);
  shuffled.forEach(opt=>{
    const b = document.createElement('button');
    b.className = 'btn'; // leave all buttons visually normal
    b.innerText = opt.t;
    b.onclick = () => handleChoice(opt);
    choicesDiv.appendChild(b);
  });
  updateMeta();
}

/* handle choice selection */
function handleChoice(opt){
  // normalize score: >0 => +1, 0 => 0, <0 => -1
  const normalized = opt.score > 0 ? 1 : (opt.score < 0 ? -1 : 0);

  if(normalized > 0){
    // fireworks in random center area
    const rect = game.getBoundingClientRect();
    const x = (rect.width * (0.45 + Math.random()*0.1));
    const y = (rect.height * (0.28 + Math.random()*0.08));
    const c = randomColorRGB();
    spawnFireworks(x,y,c);
    playCorrectSound();
  } else if(normalized < 0){
    xEffect.innerText = '‚ùå';
    xEffect.style.color = 'var(--bad)';
    xEffect.style.display = 'block';
    playWrongSound();
    setTimeout(()=>{ xEffect.style.display = 'none'; }, 900);
  } else {
    // neutral (meia-certa)
    xEffect.innerText = 'üëå';
    xEffect.style.color = 'var(--neutral)';
    xEffect.style.display = 'block';
    playNeutralSound();
    setTimeout(()=>{ xEffect.style.display = 'none'; }, 700);
  }

  // update scores by type using normalized value
  if(opt.type === 'env') scores.env += normalized;
  if(opt.type === 'eth') scores.eth += normalized;
  if(opt.type === 'resp') scores.resp += normalized;

  // show message and continue button
  questionDiv.innerText = opt.msg;
  choicesDiv.innerHTML = `<button id="continue" class="btn" onclick="nextQ()">Continuar</button>`;
  updateMeta();
}

/* go next */
function nextQ(){
  sceneIndex++;
  showScene();
}

/* start / restart helpers */
function start(){
  // activate audio context on user gesture
  ensureAudio();
  resetGame();
  showScene();
}
function restartGame(){ start(); }

/* wire start button */
document.getElementById('startBtn').addEventListener('click', ()=>{
  start();
});

/* Initial meta */
updateMeta();

</script>
</body>
</html>
